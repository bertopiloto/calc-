<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Calculadora iOS — Vidro (iPhone fullscreen)</title>
<link rel="apple-touch-icon" href="data:image/png;base64,iVBORw0KGgo=" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<style>
  :root{
    --accent:#ff9f0a;
    --txt:#fff; --muted:rgba(255,255,255,.75);
    --glassA:rgba(255,255,255,.10); --glassB:rgba(255,255,255,.16);
    --border:rgba(255,255,255,.30);
    --blur: min(30px, 3.2vw);
    --bg1:#090a10; --bg2:#141824;
    --font: ui-rounded, SF Pro Rounded, Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial;
    --panel-w: min(94vw, 560px);
    --panel-pad: clamp(12px, 2.2vmin, 24px);
    --btn-h: clamp(58px, 9.6vmin, 88px);
    --btn-gap: clamp(8px, 1.8vmin, 14px);
    --btn-font: clamp(18px, 2.8vmin, 28px);
    --display-font: clamp(40px, 6.6vmin, 86px);
    --hint-font: clamp(10px, 1.8vmin, 14px);
    --radius: clamp(20px, 3vmin, 36px);
    --pill-radius: 999px;
  }
  @media (prefers-color-scheme: light){
    :root{ --txt:#0f1216; --muted:rgba(0,0,0,.65);
      --glassA:rgba(255,255,255,.55); --glassB:rgba(255,255,255,.7); --border:rgba(255,255,255,.9);
      --bg1:#e8eefc; --bg2:#f6f8ff;
    }
  }
  *{box-sizing:border-box}
  html,body{
    height:100%; margin:0; font-family:var(--font); color:var(--txt); overflow:hidden;
    background:
      radial-gradient(1200px 900px at 12% 8%, #ff835a22 0%, transparent 60%),
      radial-gradient(1100px 800px at 88% 18%, #58c6ff22 0%, transparent 60%),
      radial-gradient(1000px 1000px at 50% 120%, #a8ffce20 0%, transparent 60%),
      linear-gradient(160deg, var(--bg1), var(--bg2));
    -webkit-tap-highlight-color: transparent;
  }
  .liquid{ position:fixed; inset:-20%; pointer-events:none; filter: blur(60px) saturate(120%);
    background:
      radial-gradient(520px 420px at 20% 25%, #ffffff14 0%, #ffffff00 70%),
      radial-gradient(680px 520px at 80% 35%, #ffffff12 0%, #ffffff00 70%),
      radial-gradient(760px 640px at 45% 85%, #ffffff10 0%, #ffffff00 70%);
    animation: float 22s ease-in-out infinite alternate;
  }
  @keyframes float{ 0%{ transform: translate3d(-2%,-1%,0) scale(1.02);} 100%{ transform: translate3d(2%,1%,0) scale(1.06);} }

  .wrap{
    height:100%;
    display:grid;
    place-items:center;
    padding: max(14px, env(safe-area-inset-top))
             max(16px, env(safe-area-inset-right))
             max(22px, env(safe-area-inset-bottom))
             max(16px, env(safe-area-inset-left));
  }

  .panel{
    width: var(--panel-w);
    border-radius: var(--radius);
    background: linear-gradient(180deg, var(--glassB), var(--glassA));
    backdrop-filter: blur(var(--blur)) saturate(135%); -webkit-backdrop-filter: blur(var(--blur)) saturate(135%);
    border:1px solid var(--border);
    box-shadow: inset 0 1px 0 rgba(255,255,255,.35), 0 30px 80px rgba(0,0,0,.40);
    padding: var(--panel-pad);
    position:relative; overflow:hidden;
  }
  .panel::before{ content:""; position:absolute; inset:0; border-radius:inherit; pointer-events:none;
    background:
      linear-gradient(180deg, rgba(255,255,255,.40), transparent 26%),
      radial-gradient(120% 60% at 10% -10%, rgba(255,255,255,.18), transparent 40%),
      radial-gradient(140% 80% at 110% 120%, rgba(255,255,255,.08), transparent 40%),
      url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='120' height='120'><filter id='n'><feTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='2'/><feColorMatrix type='saturate' values='0'/><feComponentTransfer><feFuncA type='table' tableValues='0 0 0 0 0.04 0'/></feComponentTransfer></filter><rect width='100%' height='100%' filter='url(%23n)'/></svg>") repeat;
    mix-blend-mode: soft-light; opacity:.45;
  }

  .display{
    position:relative; border-radius: calc(var(--radius) - 8px);
    padding: clamp(12px, 2vmin, 22px) clamp(10px, 2vmin, 18px);
    margin-bottom: clamp(8px, 1.6vmin, 14px);
    background: linear-gradient(180deg, rgba(255,255,255,.18), rgba(255,255,255,.08));
    border:1px solid rgba(255,255,255,.30);
    backdrop-filter: blur(18px); -webkit-backdrop-filter: blur(18px);
    box-shadow: inset 0 1px 0 rgba(255,255,255,.38), 0 14px 28px rgba(0,0,0,.25);
    overflow:hidden;
  }
  .value{
    font-variant-numeric: tabular-nums; font-weight:700; letter-spacing:.5px;
    font-size: var(--display-font);
    text-align: right; color: var(--txt); text-shadow: 0 2px 8px rgba(0,0,0,.25);
    min-height: 1.3em;
  }
  .hint{ position:absolute; left:10px; top:8px; font-size: var(--hint-font); color: var(--muted); }

  .particles, .heat{ position:absolute; inset:0; pointer-events:none; overflow:visible; }
  .speck{
    position:absolute; width:5px; height:5px; border-radius:50%;
    background: rgba(255,255,255,.9); filter: blur(1px);
    opacity:0; transform: translate(0,0) scale(1);
    animation: vapor 650ms ease-out forwards;
  }
  @keyframes vapor{
    0%{ opacity:.95; transform: translate(0,0) scale(1); filter: blur(0); }
    60%{ opacity:.55; transform: translate(var(--dx), var(--dy)) scale(1.15) rotate(var(--rot)); filter: blur(2px); }
    100%{ opacity:0; transform: translate(calc(var(--dx)*1.35), calc(var(--dy)*1.35)) scale(.9) rotate(var(--rot)); filter: blur(7px); }
  }
  .heatwave{
    position:absolute; left:60%; top:55%; width:2px; height:2px; border-radius:50%;
    background: radial-gradient(closest-side, rgba(255,255,255,.7), rgba(255,255,255,0));
    transform: translate(-50%,-50%); opacity:0; filter: blur(6px);
    animation: heat 620ms ease-out forwards;
  }
  @keyframes heat{ 0%{ opacity:.5; transform: translate(-50%,-50%) scale(1);} 100%{ opacity:0; transform: translate(-50%,-50%) scale(26);} }

  .grid{
    display:grid; grid-template-columns: repeat(4, 1fr);
    gap: var(--btn-gap);
    padding: clamp(4px, 1vmin, 10px);
  }
  .btn{
    border:0; border-radius: var(--pill-radius);
    height: var(--btn-h);
    cursor:pointer; user-select:none; font-weight:600;
    font-size: var(--btn-font);
    background: linear-gradient(180deg, rgba(255,255,255,.22), rgba(255,255,255,.10));
    border:1px solid rgba(255,255,255,.32);
    backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
    box-shadow: inset 0 1px 0 rgba(255,255,255,.45), 0 12px 26px rgba(0,0,0,.26);
    color: var(--txt);
    position:relative; overflow:hidden;
    transition: transform .06s ease, box-shadow .12s ease, background .2s ease;
    touch-action: manipulation;
  }
  .btn::before{
    content:""; position:absolute; inset:0; border-radius:inherit; pointer-events:none;
    background: radial-gradient(120% 80% at 50% -20%, rgba(255,255,255,.22), transparent 60%);
    mix-blend-mode: screen;
  }
  .btn:active{ transform: translateY(1px) scale(.995); box-shadow: inset 0 2px 8px rgba(0,0,0,.25), 0 8px 18px rgba(0,0,0,.22); }

  .btn.util{ color: #0f0f10; background: linear-gradient(180deg, rgba(255,255,255,.85), rgba(255,255,255,.65)); border-color: rgba(255,255,255,.9); }
  .btn.num{ color: var(--txt); background: linear-gradient(180deg, rgba(255,255,255,.14), rgba(255,255,255,.07)); }
  .btn.op{ color:#111; background: linear-gradient(180deg, #ffd699, #ffb347); border-color: #ffc27a; }
  .btn.eq{ background: linear-gradient(180deg, #ffb347, var(--accent)); color:#111; border-color:#ffbf66; }

  .btn.op.active{
    outline:3px solid rgba(255,255,255,.55);
    box-shadow: inset 0 1px 0 rgba(255,255,255,.45), 0 10px 28px rgba(255,159,10,.50);
  }

  @media (max-height: 520px) and (orientation: landscape){
    :root{
      --panel-w: min(96vw, 780px);
      --btn-h: clamp(46px, 12vmin, 72px);
      --display-font: clamp(30px, 8vmin, 64px);
    }
    .wrap{ padding: 8px; }
  }
</style>
</head>
<body>
<div class="liquid"></div>

<div class="wrap">
  <div class="panel" role="application" aria-label="Calculadora iOS vidro">
    <div class="display" id="displayBox">
      <span class="hint">← arraste para apagar</span>
      <div class="particles" id="particles"></div>
      <div class="heat" id="heat"></div>
      <div class="value" id="display">0</div>
    </div>

    <div class="grid">
      <button class="btn util" data-act="clear">C</button>
      <button class="btn util" data-act="toggleSign">+/-</button>
      <button class="btn util" data-act="percent">%</button>
      <button class="btn op"   data-op="÷">÷</button>

      <button class="btn num" data-num="7">7</button>
      <button class="btn num" data-num="8">8</button>
      <button class="btn num" data-num="9">9</button>
      <button class="btn op" data-op="×">×</button>

      <button class="btn num" data-num="4">4</button>
      <button class="btn num" data-num="5">5</button>
      <button class="btn num" data-num="6">6</button>
      <button class="btn op" data-op="−">−</button>

      <button class="btn num" data-num="1">1</button>
      <button class="btn num" data-num="2">2</button>
      <button class="btn num" data-num="3">3</button>
      <button class="btn op" data-op="+">+</button>

      <button class="btn num" data-num="0">0</button>
      <button class="btn num" data-act="dot">,</button>
      <button class="btn num" data-act="backspace">⌫</button>
      <button class="btn eq" data-act="equals">=</button>
    </div>
  </div>
</div>

<script>
  const displayEl = document.getElementById('display');
  const particlesEl = document.getElementById('particles');
  const heatEl = document.getElementById('heat');
  const displayBox = document.getElementById('displayBox');

  const opBtns = () => Array.from(document.querySelectorAll('.btn.op'));

  let current='0', stored=null, pendingOp=null, justEvaluated=false, hasDecimal=false;

  const fmt = (v) => {
    const s = v.toString();
    if (!s.includes('.')) return Number(s).toLocaleString('pt-BR');
    const [i,d]=s.split('.');
    return Number(i).toLocaleString('pt-BR') + ',' + d.replace(/0+$/,'');
  };
  const setDisplay = (s)=> displayEl.textContent = fmt(s);
  const clearActiveOps = ()=> opBtns().forEach(b=>b.classList.remove('active'));
  const setActiveOp = (op)=>{ clearActiveOps(); const b=opBtns().find(x=>x.dataset.op===op); if(b) b.classList.add('active'); };
  const applyOp = (a,b,op)=>{ a=Number(a); b=Number(b); return op==='+'?a+b:op==='−'?a-b:op==='×'?a*b:op==='÷'?(b===0?NaN:a/b):b; };

  function evaporate(){
    const rect = displayEl.getBoundingClientRect();
    const panelRect = particlesEl.getBoundingClientRect();
    const cx = rect.left + rect.width * 0.6;
    const cy = rect.top + rect.height * 0.6;
    const n = 26;
    for (let i=0;i<n;i++){
      const p = document.createElement('div');
      p.className='speck';
      const ang = (Math.random()*Math.PI*1.2) - Math.PI*0.1;
      const dist = 24 + Math.random()*60;
      const rot = (Math.random()*40-20)+'deg';
      const dx = Math.cos(ang)*dist;
      const dy = -Math.sin(ang)*dist - Math.random()*20;
      p.style.setProperty('--dx', dx+'px');
      p.style.setProperty('--dy', dy+'px');
      p.style.setProperty('--rot', rot);
      p.style.left = (cx - panelRect.left) + 'px';
      p.style.top  = (cy - panelRect.top) + 'px';
      particlesEl.appendChild(p);
      p.addEventListener('animationend', ()=> p.remove());
    }
    const wave = document.createElement('div');
    wave.className='heatwave'; heatEl.appendChild(wave);
    wave.addEventListener('animationend', ()=> wave.remove());
  }

  const updateAC = ()=>{
    const ac=document.querySelector('[data-act="clear"]');
    ac.textContent = (current==='0' && !stored && !pendingOp) ? 'AC' : 'C';
  };

  const inputDigit = (d)=>{
    if (justEvaluated){ current=d; justEvaluated=false; hasDecimal=false; }
    else{
      if (current==='0' && d!=='0' && !hasDecimal) current=d; else current+=d;
    }
    setDisplay(current); updateAC();
  };
  const inputDot = ()=>{
    if (!hasDecimal){
      if (!current.includes('.')) current+='.';
      if (current==='.') current='0.';
      hasDecimal=true; setDisplay(current); updateAC();
    }
  };
  const toggleSign = ()=>{ if(current.startsWith('-')) current=current.slice(1); else if(current!=='0') current='-'+current; setDisplay(current); };
  const percent = ()=>{ current=(Number(current)/100).toString(); setDisplay(current); };

  const clearAll = ()=>{
    if (current!=='0') evaporate();
    current='0'; stored=null; pendingOp=null; justEvaluated=false; hasDecimal=false;
    setDisplay(current); updateAC(); clearActiveOps();
  };
  const clearEntry = ()=>{
    if (current!=='0') evaporate();
    current='0'; hasDecimal=false; setDisplay(current); updateAC();
  };
  const backspace = ()=>{
    if (current==='0') return;
    current = current.slice(0,-1);
    if (current==='' || current==='-' || current==='-0'){ evaporate(); current='0'; }
    setDisplay(current); updateAC(); hasDecimal=current.includes('.');
  };

  const chooseOp = (op)=>{
    if (pendingOp && stored!==null && !justEvaluated){
      stored = applyOp(stored, current, pendingOp).toString();
      setDisplay(stored); current='0'; hasDecimal=false;
    } else { stored=current; current='0'; hasDecimal=false; }
    pendingOp=op; justEvaluated=false; setActiveOp(op); updateAC();
  };
  const equals = ()=>{
    if (!pendingOp){ setDisplay(current); return; }
    const result = applyOp(stored, current, pendingOp);
    current = isNaN(result)?'Erro':result.toString();
    stored=null; pendingOp=null; setDisplay(current); clearActiveOps();
    justEvaluated=true; hasDecimal=current.includes('.');
  };

  document.querySelector('.grid').addEventListener('click',(e)=>{
    const b=e.target.closest('button'); if(!b) return;
    if (b.dataset.num!==undefined) return inputDigit(b.dataset.num);
    if (b.dataset.op) return chooseOp(b.dataset.op);
    switch(b.dataset.act){
      case 'dot': inputDot(); break;
      case 'toggleSign': toggleSign(); break;
      case 'percent': percent(); break;
      case 'equals': equals(); break;
      case 'backspace': backspace(); break;
      case 'clear':
        const label = b.textContent.trim();
        (label==='AC') ? clearAll() : clearEntry();
        break;
    }
  });

  let startX=null;
  displayBox.addEventListener('pointerdown',(e)=>{ startX=e.clientX; });
  displayBox.addEventListener('pointerup',(e)=>{
    if (startX!==null && e.clientX < startX - 20) backspace();
    startX=null;
  });

  window.addEventListener('keydown',(e)=>{
    const k=e.key;
    if (/\d/.test(k)) inputDigit(k);
    else if (k===','||k==='.') inputDot();
    else if (k==='+') chooseOp('+');
    else if (k==='-') chooseOp('−');
    else if (k==='*') chooseOp('×');
    else if (k==='/') chooseOp('÷');
    else if (k==='Enter'||k==='=') equals();
    else if (k==='%') percent();
    else if (k==='Backspace') backspace();
    else if (k==='Escape'||k.toLowerCase()==='c') clearAll();
  });

  setDisplay('0'); updateAC();
</script>
</body>
</html>
